# TViMS / Math Statistics — Regression Model (Least Squares), Variant 48

Учебный проект по ТВиМС: построение нормальной регрессии для полиномиального сигнала и оценивание параметров методом наименьших квадратов (МНК) с доверительными интервалами и проверкой нормальности остатков.

## Задание (кратко)

Наблюдения задаются моделью:

- Полезный сигнал:

  $$y(x) = \theta_0 + \theta_1 x + \theta_2 x^2$$

- Наблюдения:

  $$y_k = \theta_0 + \theta_1 x_k + \theta_2 x_k^2 + \varepsilon_k$$

- Узлы:

  $$x_k = -1 + \frac{k-1}{20}, \quad k = 1..41$$

- Ошибка:

  $$\varepsilon_k \sim \mathcal{N}(0, \sigma^2), \text{ независимы}$$

Данные берутся из Excel-файла `Data48.xlsx`.

## Что делает проект

После запуска `main.py` выполняются вычисления и выводятся результаты:

- построение матрицы регрессоров `X` и вспомогательных матриц (`X^T`, `X^T X`, `(X^T X)^{-1}`)
- МНК-оценка параметров `theta` и печать вида функции \(\varphi(x;\hat\theta)\)
- центральные доверительные интервалы для `theta` на уровнях надёжности `0.95` и `0.99`
- оценка дисперсии ошибки \(\sigma^2\)
- центральные доверительные интервалы для \(\sigma^2\) на уровнях надёжности `0.95` и `0.99`
- доверительные интервалы для полезного сигнала \(y(x)\) на уровнях `0.95` и `0.99`
- построение графиков и гистограммы остатков
- проверка гипотезы о нормальности остатков \(\chi^2\)-критерием Пирсона (сравнение статистики с критическими значениями)

## Структура репозитория

- `regression_model/` — модуль с реализацией модели регрессии и вычислений
- `main.py` — точка входа (читает Excel, строит модель, печатает результаты и показывает графики)
- `requirements.txt` — зависимости
- `Data48.xlsx` — данные (если файл не публикуется, см. раздел “Данные”)

## Требования

- Python 3.9+ (желательно 3.10+)

## Установка

```bash
git clone https://github.com/<your-username>/<repo>.git
cd <repo>

python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate

pip install -r requirements.txt
```
## Данные

Скрипт ожидает файл c исходными наблюдениями в корне проекта:

Data48.xlsx

Если файл лежит в другом месте — измените путь в main.py:

```python
wb = openpyxl.load_workbook(f"Data{VARIANT}.xlsx")
```
## Запуск
```python
python main.py
```
## Как это работает (в `main.py`)

1. Загружается файл с данными `Data48.xlsx`.
2. Формируется массив наблюдений `Y_values` из 1-го столбца Excel.
3. Формируются значения `x_values` по формуле:
   
   $$x_k = -1 + \frac{k-1}{20}, \quad k = 1..41$$

4. Создаётся и вычисляется модель:
   
   ```python
   model = rg.RegressionModel(x_values, Y_values, [rg.Polynomial(2)]).calculate()
```
5. Печатаются результаты и отображаются графики:
```python
work(model)
```
## Отчёт
- [PDF-отчёт](docs/report.pdf)
